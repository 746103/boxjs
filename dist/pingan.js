(()=>{var t={642:()=>{},969:t=>{"use strict";t.exports={}}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={exports:{}};return t[o](i,i.exports,n),i.exports}(()=>{"use strict";var t,e,o,r,i=(t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}),s=function(){return s=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},s.apply(this,arguments)},a=function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function s(t){try{c(o.next(t))}catch(t){i(t)}}function a(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((o=o.apply(t,e||[])).next())}))},c=function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,o=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},u=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))};n(969),function(t){t.Surge="Surge",t.Loon="Loon",t.QuanX="QuanX",t.Shadowrocket="Shadowrocket",t.Node="Node"}(e||(e={})),function(t){t.Response="http-response",t.Request="http-request",t.Script="run-script"}(o||(o={})),function(t){t[t.BASE=0]="BASE",t[t.HTTP=1]="HTTP",t[t.SYS=2]="SYS",t[t.OTHER=3]="OTHER"}(r||(r={}));var p=function(t){function e(n,o){void 0===o&&(o=r.BASE);var i=t.call(this,n)||this;return i.name="baseErr",i.code=o,i.stack=(new Error).stack,Object.setPrototypeOf(i,e.prototype),i}return i(e,t),e}(Error);const h=function(){function t(t,e){this.isMute=!1,this.logList=[],this.logSeparator="\n\n",this.response={},this.appName=t,this.namespace=e,this.startTime=(new Date).getTime(),this.log("üîî".concat(this.appName,", ÂºÄÂßã!")),this.initAction(),this.initEnv();var n=this.getStore("mute");this.isMute="true"==n}return t.prototype.initAction=function(){"undefined"!=typeof $response?this.action=o.Response:"undefined"!=typeof $request?this.action=o.Request:this.action=o.Script,this.log("ËÑöÊú¨Á±ªÂûã‰∏∫Ôºö"+this.action)},t.prototype.run=function(){var t=this;this.doAction().catch((function(e){e instanceof p?(t.log(""+e.code),e.code==r.BASE?t.msg(t.appName,e.message,""):e.code==r.HTTP?Math.random()>.8?t.msg(t.appName,"ÁΩëÁªúÂºÇÂ∏∏Ôºö"+e.message,""):t.log(t.appName,"ÁΩëÁªúÂºÇÂ∏∏Log:"+e.message,""):t.log(e.message,"")):t.log(e),t.ajaxFail(e.message||e)})).finally((function(){t.done()}))},t.prototype.transParams=function(t){return Object.keys(t).map((function(e){return"".concat(e,"=").concat(encodeURIComponent(t[e]))})).join("&")},t.prototype.httpResponse=function(t,e){void 0===e&&(e={}),this.response={response:{status:200,body:"string"==typeof t?t:JSON.stringify(t),headers:s(s({},{"Content-Type":"application/json; charset=utf-8","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,GET","Access-Control-Allow-Headers":"Origin, X-Requested-With, Content-Type, Accept"}),e)}}},t.prototype.randomString=function(t){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=n.length,r=0;r<t;r++)e+=n.charAt(Math.floor(Math.random()*o));return e},t.prototype.handelLogHttp=function(){this.log("ËøêË°å „Äã ".concat(this.appName,"Á≥ªÁªüËøêË°åÊó•ÂøóhttpÊúçÂä°Âô®"));var e=this.getStore(t.APP_LOG_KEY)||"",n=new RegExp(this.logSeparator,"g");e=e.replace(n,"<br>"),this.httpResponse(e,{"Content-Type":"text/html;charset=utf-8"})},t.prototype.send=function(t){var e=this;return new Promise((function(n,o){e.doRequest(t,(function(t,e,i){t?o(new p(t,r.HTTP)):n(e)}))}))},t.prototype.post=function(t){return a(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return t.method="post",[4,this.send(t)];case 1:return[2,e.sent()]}}))}))},t.prototype.get=function(t){return a(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return t.method="get",[4,this.send(t)];case 1:return[2,e.sent()]}}))}))},t.prototype.doRequest=function(t,n){void 0===n&&(n=function(t,e,n){});var o=t.method?t.method.toLocaleLowerCase():"post";t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.env==e.Surge||this.env==e.Shadowrocket||this.env==e.Loon?(this.env==e.Surge&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient[o](t,(function(t,e,o){!t&&e&&(e.body=o,e.statusCode=e.status?e.status:e.statusCode,e.status=e.statusCode),n(t,e,o)}))):this.env==e.QuanX?(t.method=o,this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then((function(t){var e=t.statusCode,o=t.statusCode,r=t.headers,i=t.body;n(null,{status:e,statusCode:o,headers:r,body:i},i)}),(function(t){return n(t&&t.error||"UndefinedError",null,null)}))):this.env==e.Node&&this.print("nodejs http request",t,this.env)},t.prototype.ajaxSuccess=function(t,e){void 0===e&&(e=null);var n={time:+new Date,datetime:this.date("yyyy-MM-dd HH:mm:ss"),code:1,msg:t,data:e};this.httpResponse(n)},t.prototype.ajaxFail=function(t,e){void 0===e&&(e=null);var n={time:+new Date,datetime:this.date("yyyy-MM-dd HH:mm:ss"),code:0,msg:t,data:e};this.httpResponse(n)},t.prototype.done=function(){var n=((new Date).getTime()-this.startTime)/1e3;if(this.print("ËøêË°å response: "+JSON.stringify(this.response)),this.log("üîî".concat(this.appName,", ÁªìÊùü! üïõ ").concat(n," Áßí ").concat(this.logSeparator)),this.env==e.Node)process.exit(1);else{var o=this.getStore(t.APP_LOG_KEY)||"";o=o.split(this.logSeparator).slice(0,1e4).join(this.logSeparator),o=this.logList.join("")+o,this.setStore(t.APP_LOG_KEY,o),this.print("Ê≥®ÊÑèÊú¨Ê¨°ËøêË°åÊó•ÂøóÂ∑≤ÁºìÂ≠òÂà∞ÂèòÈáè ".concat(this.namespace+"."+t.APP_LOG_KEY)),$done(this.response)}},t.prototype.msg=function(t,n,o){this.isMute||(this.log("==============üì£Á≥ªÁªüÈÄöÁü•üì£=============="+this.logSeparator+t+this.logSeparator+n+this.logSeparator+o),this.env==e.Surge||this.env==e.Shadowrocket||this.env==e.Loon?$notification.post(t,n,o):this.env==e.QuanX&&$notify(t,n,o))},t.prototype.print=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e=e.map((function(e){return t.date("yyyy-MM-dd HH:mm:ss")+" "+e+t.logSeparator})),console.log(e.join(this.logSeparator))},t.prototype.log=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];(e=e.map((function(e){return t.date("yyyy-MM-dd HH:mm:ss")+" "+("string"==typeof e?e:JSON.stringify(e))+t.logSeparator}))).length>0&&(this.logList=u(u([],this.logList,!0),e,!0)),console.log(e.join(this.logSeparator))},t.prototype.getStore=function(t,n){return void 0===n&&(n=!0),n&&(t=this.namespace+"."+t),this.env==e.Surge||this.env==e.Shadowrocket||this.env==e.Loon?$persistentStore.read(t):this.env==e.QuanX?$prefs.valueForKey(t):null},t.prototype.setStore=function(t,n,o){return void 0===o&&(o=!0),o&&(t=this.namespace+"."+t),this.env==e.Surge||this.env==e.Shadowrocket||this.env==e.Loon?$persistentStore.write(n,t):this.env==e.QuanX&&$prefs.setValueForKey(n,t)},t.prototype.initEnv=function(){"undefined"!=typeof $task?this.env=e.QuanX:"undefined"!=typeof $loon?this.env=e.Loon:"undefined"!=typeof $rocket?this.env=e.Shadowrocket:"undefined"!=typeof $httpClient&&"undefined"==typeof $loon?this.env=e.Surge:this.env=e.Node,this.log("ÂΩìÂâçAPP‰∏∫: "+this.env)},t.prototype.date=function(t,e){void 0===e&&(e="");var n=e?new Date(e):new Date,o={"M+":n.getMonth()+1,"d+":n.getDate(),"H+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),S:n.getMilliseconds()};for(var r in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length))),o){var i=o[r];new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i:("00"+i).substr((""+i).length)))}return t},t.prototype.getSignCount=function(){var t=this.getStore("sign_count"),e=this.date("yyyyMMdd");if(t){var n=t.split("_"),o=n[0],r=n[1];return o==e&&r?Number(r):(this.setStore("sign_count","".concat(e,"_0")),0)}return this.setStore("sign_count","".concat(e,"_0")),0},t.prototype.incSignCount=function(){var t=this.getSignCount();t++;var e=this.date("yyyyMMdd");this.setStore("sign_count","".concat(e,"_").concat(t))},t.APP_LOG_KEY="boxjs-log",t}();var l=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();n(642),new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.doAction=function(){return t=this,e=void 0,i=function(){var t,e;return function(t,e){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,o=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,(function(n){switch(this.action){case o.Request:$request.url.includes("pingan.log")&&this.handelLogHttp();break;case o.Response:if($request.url.includes("baiyunuser/entranceguard/getList"))try{(t=JSON.parse($response.body)).obj=t.obj.map((function(t){return t.limitTime="2099-09-17",t})),e=JSON.stringify(t),this.log(e),this.response={body:e}}catch(t){throw this.log("Ëß£ÊûêjsonÂ§±Ë¥•,‰øÆÊîπÂìçÂ∫î‰ΩìÂ§±Ë¥•",{url:$request.url,body:$response.body}),new p("‰øÆÊîπÂìçÂ∫îÊï∞ÊçÆÂ§±Ë¥•",r.BASE)}case o.Script:}return[2]}))},new((n=void 0)||(n=Promise))((function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}));var t,e,n,i},e}(h))("Âπ≥ÂÆâÁôΩ‰∫ë","gsonhub.pingan").run()})()})();